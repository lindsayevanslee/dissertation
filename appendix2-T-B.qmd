---
title: "T-B"
---

# Oxford, Bodleian, Canonici Misc. 74

```{r setup, include=FALSE}
# Load the xml2 package
library(xml2)
```

::: {.column-body-outset}
::: {layout="[[6,6,6,6]]"}

::: {.column}
## Nearly Diplomatic

```{r results='asis'}
# START OF "NEARLY DIPLOMATIC" CODE
# Read the XML content
xml_file <- read_xml("data/T-B-nearly_diplomatic.xml")

# Extract <l>, <cb>, and <pb> elements
lines <- xml_find_all(xml_file, "//text//l | //text//cb | //text//pb")

# Initialize an empty list to store the processed lines
processed_lines <- list()

# Function to process each element
process_line <- function(line) {
  
  # Handle column breaks
  if (xml_name(line) == "cb") {
    return("<div class='column-break'></div>")
  }
  
    # Process emph elements (decorative initials)
  emph_elements <- xml_find_all(line, ".//emph")
  for (emph in emph_elements) {
    # Get the initial letter text
    initial_letter <- xml_text(emph)
    
    # Get the size attribute (n) and style attribute (rend)
    size_attr <- xml_attr(emph, "n")
    style_attr <- xml_attr(emph, "rend")
    
    # Create the HTML for the styled initial
    styled_initial <- sprintf('<span class="decorative-initial %s" data-size="%s">%s</span>', 
                             style_attr, size_attr, initial_letter)
    
    # Replace the emph element with the styled HTML
    xml_text(emph) <- styled_initial
  }
  
  # Process choice elements
  choices <- xml_find_all(line, ".//choice")
  for (choice in choices) {
    orig_text <- xml_text(xml_find_first(choice, ".//orig"))
    xml_set_text(choice, orig_text)
  }
  
  # Remove reg elements
  reg_elements <- xml_find_all(line, ".//reg")
  xml_remove(reg_elements)
  
  # Return processed line text
  return(sprintf("<div style='line-height: 1.2;'>%s</div>", xml_text(line)))
}

# Process each line
for (line in lines) {
  processed_lines <- c(processed_lines, process_line(line))
}

# Format and print
formatted_text <- paste(processed_lines, collapse = "\n")
cat(formatted_text)

```
:::

::: {.column}
## Minimal

```{r results='asis'}
# START OF "MINIMAL" CODE
# Read the XML content
xml_file <- read_xml("data/T-B.xml")

# Extract both <l>, <cb>, and <pb> elements
lines <- xml_find_all(xml_file, "//text//l | //text//cb | //text//pb")

# Initialize an empty list to store the processed lines
processed_lines <- list()

# Initialize line counter
line_count <- 0

# Function to process each element
process_line <- function(line) {
  # Handle page breaks differently
  if (xml_name(line) == "pb") {
    # Get folio number and format as standalone line
    folio_num <- xml_attr(line, "n")
    return(sprintf("<div class='folio-number'>%s</div>", folio_num))
  }
  
  # Only increment line count for verse lines
  if (xml_name(line) == "l") {
    line_count <<- line_count + 1
    
    # SPECIAL CASE: Hard-code line v.895 to correct spacing
    if (line_count == 895) {
      return("<div style='line-height: 1.2;'>Dame Zosimas lirespot .</div>")
    }
    
    # Add line number div every 5th line
    line_number <- if (line_count %% 5 == 0) {
      sprintf("<div class='line-number'>%d</div>", line_count)
    } else {
      ""
    }
  } else {
    line_number <- ""
  }
  
  # Process emph elements (decorative initials)
  emph_elements <- xml_find_all(line, ".//emph")
  for (emph in emph_elements) {
    # Get the initial letter text
    initial_letter <- xml_text(emph)
    
    # Get the size attribute (n) and style attribute (rend)
    size_attr <- xml_attr(emph, "n")
    style_attr <- xml_attr(emph, "rend")
    
    # Create the HTML for the styled initial
    styled_initial <- sprintf('<span class="decorative-initial %s" data-size="%s">%s</span>', 
                             style_attr, size_attr, initial_letter)
    
    # Replace the emph element with the styled HTML
    xml_text(emph) <- styled_initial
  }
  
  # Find all <choice> elements within the line
  choices <- xml_find_all(line, ".//choice")
  for (choice in choices) {
    # Extract the text from the <orig> tag
    orig_text <- xml_text(xml_find_first(choice, ".//orig"))
    # Remove the <choice> element and replace it with the text from the <orig> tag
    xml_set_text(choice, paste0(orig_text, " "))
  }
  
  # Now we want to remove any <reg> elements entirely
  reg_elements <- xml_find_all(line, ".//reg")
  xml_remove(reg_elements)
  
  # Replace <lb/> tags with HTML line break
  lb_elements <- xml_find_all(line, ".//lb")
  for (lb in lb_elements) {
    xml_set_text(lb, "")
  }
  
  # Return line with number if applicable - using xml_text() instead of as.character()
  return(sprintf("<div style='line-height: 1.2;'>%s%s</div>", 
                line_number, xml_text(line)))
}

# Process each line and wrap with <div class='column-break'> at each <cb/>
for (line in lines) {
  if (xml_name(line) == "cb") {
    # Add a closing </div> for the previous column and an opening <div> for the new column
    processed_lines <- c(processed_lines, "</div>", "<div class='column-break'>")
  } else {
    # Process the line and add it to the current column
    processed_lines <- c(processed_lines, process_line(line))
  }
}

# Process lines and wrap in edition-text div
formatted_text <- paste(c("<div class='edition-text'>", processed_lines, "</div>"), collapse = "\n")
cat(formatted_text)

```

:::

::: {.column}
## Intermediate

```{r results='asis'}
# START OF "INTERMEDIATE" CODE
# Read the XML content
xml_file <- read_xml("data/T-B.xml")

# Extract the <l>, <cb>, and <pb> elements inside the <text> element
lines <- xml_find_all(xml_file, "//text//l | //text//cb | //text//pb")

# Initialize an empty list to store the processed lines
processed_lines <- list()

# Initialize line counter
line_count <- 0

# Function to process each element
process_line <- function(line) {
  # Handle page breaks differently
  if (xml_name(line) == "pb") {
    # Get folio number and format as standalone line
    folio_num <- xml_attr(line, "n")
    return(sprintf("<div class='folio-number'>%s</div>", folio_num))
  }
  
  # Only increment line count for verse lines
  if (xml_name(line) == "l") {
    line_count <<- line_count + 1
    
    # SPECIAL CASE: Hard-code line v.5 to correct apostrophe
    if (line_count == 5) {
      return("<div style='line-height: 1.2;'>bien croi que volentiers lorunt .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.15 to correct apostrophe
    if (line_count == 15) {
      return("<div style='line-height: 1.2;'>Que nuz pechiez nen est tant granz.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.23 to correct apostrophe
    if (line_count == 23) {
      return("<div style='line-height: 1.2;'>pechiez nen est pas creature .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.36 to correct apostrophe
    if (line_count == 36) {
      return("<div style='line-height: 1.2;'>tros quil sent el cors le mort</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.37 to correct spacing
    if (line_count == 37) {
      return("<div style='line-height: 1.2;'>cant il semuert & il lesent .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.52 to correct apostrophe
    if (line_count == 52) {
      return("<div style='line-height: 1.2;'>kanquele at fait tot trovera</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.56 to correct apostrophe
    if (line_count == 56) {
      return("<div style='line-height: 1.2;'>quele fut nee enegypte</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.59 to correct apostrophe
    if (line_count == 59) {
      return("<div style='line-height: 1.2;'>legiere devint ensenfance .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.62 to correct spacing
    if (line_count == 62) {
      return("<div style='line-height: 1.2;'>porce kastoit & bele & gente</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.69 to correct spacing
    if (line_count == 69) {
      return("<div style='line-height: 1.2;'>sesperes & samere vivoient .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.71 to correct spacing
    if (line_count == 71) {
      return("<div style='line-height: 1.2;'>Il levoloient chastoier.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.73 to correct spacing
    if (line_count == 73) {
      return("<div style='line-height: 1.2;'>Neprisoit chastit deparent .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.76 to correct spacing
    if (line_count == 76) {
      return("<div style='line-height: 1.2;'>car croi leconsel deten pere</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.77 to correct spacing
    if (line_count == 77) {
      return("<div style='line-height: 1.2;'>selongement tiens cest mestier.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.78 to correct spacing
    if (line_count == 78) {
      return("<div style='line-height: 1.2;'>nosen arons lereprochier</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.79 to correct spacing
    if (line_count == 79) {
      return("<div style='line-height: 1.2;'>por Deuteprie filhe Marie.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.85 to correct spacing
    if (line_count == 85) {
      return("<div style='line-height: 1.2;'>Filhe tues degrant parage .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.89 to correct spacing
    if (line_count == 89) {
      return("<div style='line-height: 1.2;'>tesperes est forment iriez.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.93 to correct spacing
    if (line_count == 93) {
      return("<div style='line-height: 1.2;'>cant ot desepere parler.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.97 to correct apostrophe
    if (line_count == 97) {
      return("<div style='line-height: 1.2;'>Pus quele ot passez doze ans.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.99 to correct spacing
    if (line_count == 99) {
      return("<div style='line-height: 1.2;'>tot senparente deguerpit .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.100 to correct apostrophe
    if (line_count == 100) {
      return("<div style='line-height: 1.2;'>si konques puis nuz nela vit</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.104 to correct apostrophe
    if (line_count == 104) {
      return("<div style='line-height: 1.2;'>anc nidemandat compagnie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.108 to correct spacing
    if (line_count == 108) {
      return("<div style='line-height: 1.2;'>Illuc at fait sencors venal</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.111 to correct spacing
    if (line_count == 111) {
      return("<div style='line-height: 1.2;'>Tuit ivenoient al bordel.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.112 to correct spacing
    if (line_count == 112) {
      return("<div style='line-height: 1.2;'>porsue amor li jovencel</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.114 to correct spacing
    if (line_count == 114) {
      return("<div style='line-height: 1.2;'>nient solement parlor doniers</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.115 to correct spacing
    if (line_count == 115) {
      return("<div style='line-height: 1.2;'>Mais porfaire lesien delit.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.127 to correct spacing
    if (line_count == 127) {
      return("<div style='line-height: 1.2;'>Que devant senlit alentree .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.130 to correct apostrophe
    if (line_count == 130) {
      return("<div style='line-height: 1.2;'>sentredonoient grant colees</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.134 to correct apostrophe
    if (line_count == 134) {
      return("<div style='line-height: 1.2;'>Nule pitiet ne lenprendroit</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.138 to correct apostrophe
    if (line_count == 138) {
      return("<div style='line-height: 1.2;'>ja nen fesist plus tart un ris</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.139 to correct spacing
    if (line_count == 139) {
      return("<div style='line-height: 1.2;'>cil qui erent porli navret.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.140 to correct spacing
    if (line_count == 140) {
      return("<div style='line-height: 1.2;'>parli nefusent visitet</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.146 to correct spacing
    if (line_count == 146) {
      return("<div style='line-height: 1.2;'>mut enparastoit mahagnie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.148 to correct spacing
    if (line_count == 148) {
      return("<div style='line-height: 1.2;'>toenort agrant perdicion</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.154 to correct spacing
    if (line_count == 154) {
      return("<div style='line-height: 1.2;'>Nevit nuz homplus bele feme</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.158 to correct spacing
    if (line_count == 158) {
      return("<div style='line-height: 1.2;'>Mais blanches erent amervelhes</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.169 to correct spacing
    if (line_count == 169) {
      return("<div style='line-height: 1.2;'>Soz laboce sorlepoitrine .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.179 to correct spacing
    if (line_count == 179) {
      return("<div style='line-height: 1.2;'>Nert pas trop grant netrop petite.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.180 to correct apostrophe
    if (line_count == 180) {
      return("<div style='line-height: 1.2;'>Jasefacons neniert descrite</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.184 to correct spacing
    if (line_count == 184) {
      return("<div style='line-height: 1.2;'>cant desecreator nat cure</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.194 to correct spacing
    if (line_count == 194) {
      return("<div style='line-height: 1.2;'>chacoit partoz les jors delan</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.200 to correct spacing
    if (line_count == 200) {
      return("<div style='line-height: 1.2;'>mut fait aplendre sajovente</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.208 to correct apostrophe
    if (line_count == 208) {
      return("<div style='line-height: 1.2;'>quele ert amurs dele cite</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.210 to correct spacing
    if (line_count == 210) {
      return("<div style='line-height: 1.2;'>u soloit faire sendeport</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.215 to correct spacing
    if (line_count == 215) {
      return("<div style='line-height: 1.2;'>enJherusalem en aloient.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.216 to correct spacing
    if (line_count == 216) {
      return("<div style='line-height: 1.2;'>parbon corage sehastoient</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.218 to correct spacing
    if (line_count == 218) {
      return("<div style='line-height: 1.2;'>quidelacrois idevoit estre</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.220 to correct apostrophe
    if (line_count == 220) {
      return("<div style='line-height: 1.2;'>sensalhoient fors el gravier</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.221 to correct spacing
    if (line_count == 221) {
      return("<div style='line-height: 1.2;'>mainamain aloient jouant.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.222 to correct spacing
    if (line_count == 222) {
      return("<div style='line-height: 1.2;'>parlariviere li enfant</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.224 to correct apostrophe
    if (line_count == 224) {
      return("<div style='line-height: 1.2;'>Nepuet muer que nesenrie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.230 to correct spacing
    if (line_count == 230) {
      return("<div style='line-height: 1.2;'>qui laissent decel dromon</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.257 to correct spacing
    if (line_count == 257) {
      return("<div style='line-height: 1.2;'>A ciaz parlat auquesbriement .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.269 to correct apostrophe
    if (line_count == 269) {
      return("<div style='line-height: 1.2;'>o moi nen ai argent ne or.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.275 to correct apostrophe
    if (line_count == 275) {
      return("<div style='line-height: 1.2;'>simenvoroie ovos aler.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.277 to correct spacing
    if (line_count == 277) {
      return("<div style='line-height: 1.2;'>japorporter une caitive.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.279 to correct spacing
    if (line_count == 279) {
      return("<div style='line-height: 1.2;'>Sus enlaneif lefont monter.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.280 to correct spacing
    if (line_count == 280) {
      return("<div style='line-height: 1.2;'>puis sisefirent desaancrer</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.283 to correct spacing
    if (line_count == 283) {
      return("<div style='line-height: 1.2;'>Nefinerent li bacheler.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.284 to correct spacing
    if (line_count == 284) {
      return("<div style='line-height: 1.2;'>truesque seront enhalte mer</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.297 to correct spacing
    if (line_count == 297) {
      return("<div style='line-height: 1.2;'>& elevoit legrant oreit.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.319 to correct spacing
    if (line_count == 319) {
      return("<div style='line-height: 1.2;'>car ni conoist home nefamme .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.323 to correct spacing
    if (line_count == 323) {
      return("<div style='line-height: 1.2;'>enJherusalem est entree.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.334 to correct apostrophe
    if (line_count == 334) {
      return("<div style='line-height: 1.2;'>por ce quele astoit bele & gente</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.344 to correct spacing
    if (line_count == 344) {
      return("<div style='line-height: 1.2;'>mist soidedens la compagnie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.345 to correct spacing
    if (line_count == 345) {
      return("<div style='line-height: 1.2;'>Lipelerin quileveoient .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.346 to correct spacing
    if (line_count == 346) {
      return("<div style='line-height: 1.2;'>sencorage pas nesavoient</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.353 to correct spacing
    if (line_count == 353) {
      return("<div style='line-height: 1.2;'>dedens lepresse semetoit .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.359 to correct apostrophe
    if (line_count == 359) {
      return("<div style='line-height: 1.2;'>chascuns tenoit verslisespee .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.360 to correct spacing
    if (line_count == 360) {
      return("<div style='line-height: 1.2;'>selidefendoient lentree</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.363 to correct spacing
    if (line_count == 363) {
      return("<div style='line-height: 1.2;'>Illuc seprist aporpenser .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.370 to correct spacing
    if (line_count == 370) {
      return("<div style='line-height: 1.2;'>grans coz sedone alapoitrine</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.371 to correct spacing
    if (line_count == 371) {
      return("<div style='line-height: 1.2;'>seit keDeus est verli iriez.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.374 to correct spacing
    if (line_count == 374) {
      return("<div style='line-height: 1.2;'>commar ifustes meretrix</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.376 to correct spacing
    if (line_count == 376) {
      return("<div style='line-height: 1.2;'>porquoiDeus est vervos iriez</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.378 to correct spacing
    if (line_count == 378) {
      return("<div style='line-height: 1.2;'>cant mencreator ai perdu</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.380 to correct spacing
    if (line_count == 380) {
      return("<div style='line-height: 1.2;'>demalvastiet & deluxure</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.384 to correct apostrophe
    if (line_count == 384) {
      return("<div style='line-height: 1.2;'>celi poise qu ele est vive</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.385 to correct spacing
    if (line_count == 385) {
      return("<div style='line-height: 1.2;'>Regarde verdestrepartie .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.390 to correct spacing
    if (line_count == 390) {
      return("<div style='line-height: 1.2;'>qui enten cors portas ten pere</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.391 to correct spacing
    if (line_count == 391) {
      return("<div style='line-height: 1.2;'>Sens Gabrielenfut mesages.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.392 to correct spacing
    if (line_count == 392) {
      return("<div style='line-height: 1.2;'>tulirespondis com sage</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.400 to correct spacing
    if (line_count == 400) {
      return("<div style='line-height: 1.2;'>nequier altre medecinals</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.401 to correct spacing
    if (line_count == 401) {
      return("<div style='line-height: 1.2;'>se tu aten Filbien mapaies .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.409 to correct spacing
    if (line_count == 409) {
      return("<div style='line-height: 1.2;'>enten Fil ai megrant creance.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.415 to correct spacing
    if (line_count == 415) {
      return("<div style='line-height: 1.2;'>& enmencuer ai me creance .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.419 to correct spacing
    if (line_count == 419) {
      return("<div style='line-height: 1.2;'>Il fut tes Fiz si fut tesperes .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.424 to correct spacing
    if (line_count == 424) {
      return("<div style='line-height: 1.2;'>porcui diables fut destuiz</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.439 to correct apostrophe
    if (line_count == 439) {
      return("<div style='line-height: 1.2;'>Il dist quil ert li agniaz de.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.442 to correct spacing
    if (line_count == 442) {
      return("<div style='line-height: 1.2;'>que nos jeta deparadis</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.443 to correct spacing
    if (line_count == 443) {
      return("<div style='line-height: 1.2;'>Que il devoit lemont salver.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.445 to correct spacing
    if (line_count == 445) {
      return("<div style='line-height: 1.2;'>com il fist lepremier ome.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.450 to correct spacing
    if (line_count == 450) {
      return("<div style='line-height: 1.2;'>partraison li donat mort</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.452 to correct spacing
    if (line_count == 452) {
      return("<div style='line-height: 1.2;'>parcui lavie fut donee</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.454 to correct spacing
    if (line_count == 454) {
      return("<div style='line-height: 1.2;'>Janentresiens enparadis</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.461 to correct spacing
    if (line_count == 461) {
      return("<div style='line-height: 1.2;'>diluc les condost asenpere .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.463 to correct spacing
    if (line_count == 463) {
      return("<div style='line-height: 1.2;'>Puis vint a sepucre asencors .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.468 to correct spacing
    if (line_count == 468) {
      return("<div style='line-height: 1.2;'>puis sebaisat kasconparsoi</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.470 to correct spacing
    if (line_count == 470) {
      return("<div style='line-height: 1.2;'>enciel monta puis asenpere</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.472 to correct spacing
    if (line_count == 472) {
      return("<div style='line-height: 1.2;'>onques puis necremirent mort</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.473 to correct spacing
    if (line_count == 473) {
      return("<div style='line-height: 1.2;'>lesaint espir Deus lor tremist.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.475 to correct spacing
    if (line_count == 475) {
      return("<div style='line-height: 1.2;'>orsiet ala destre senpere .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.477 to correct spacing
    if (line_count == 477) {
      return("<div style='line-height: 1.2;'>cant il venrat aljugement .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.478 to correct spacing
    if (line_count == 478) {
      return("<div style='line-height: 1.2;'>& asesaint avenement</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.485 to correct spacing
    if (line_count == 485) {
      return("<div style='line-height: 1.2;'>Qui celui portas enten ventre .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.486 to correct spacing
    if (line_count == 486) {
      return("<div style='line-height: 1.2;'>Cui toz limons ne pooit prendre</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.494 to correct spacing
    if (line_count == 494) {
      return("<div style='line-height: 1.2;'>eltemple en entre sens dotance</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.502 to correct spacing
    if (line_count == 502) {
      return("<div style='line-height: 1.2;'>conselliquiert depenitance</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.504 to correct spacing
    if (line_count == 504) {
      return("<div style='line-height: 1.2;'>& enquel terre sen irat</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.505 to correct spacing
    if (line_count == 505) {
      return("<div style='line-height: 1.2;'>vint une voizqueeleentent .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.506 to correct spacing
    if (line_count == 506) {
      return("<div style='line-height: 1.2;'>quili at dit apertement</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.529 to correct spacing
    if (line_count == 529) {
      return("<div style='line-height: 1.2;'>ele sesent alkes lassee.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.531 to correct spacing
    if (line_count == 531) {
      return("<div style='line-height: 1.2;'>dedure piere fut senlit .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.549 to correct spacing
    if (line_count == 549) {
      return("<div style='line-height: 1.2;'>par semercit nelagerpisse .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.554 to correct spacing
    if (line_count == 554) {
      return("<div style='line-height: 1.2;'>ans selairoit defaim morir</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.558 to correct spacing
    if (line_count == 558) {
      return("<div style='line-height: 1.2;'>sedeus neli fait altre aie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.562 to correct apostrophe
    if (line_count == 562) {
      return("<div style='line-height: 1.2;'>puis fut illuc juskal demains</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.563 to correct apostrophe
    if (line_count == 563) {
      return("<div style='line-height: 1.2;'>Lendemain levat par matin.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.564 to correct spacing
    if (line_count == 564) {
      return("<div style='line-height: 1.2;'>vers orient tint senchemin</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.567 to correct spacing
    if (line_count == 567) {
      return("<div style='line-height: 1.2;'>tant errat par nuiz & pardis .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.570 to correct apostrophe
    if (line_count == 570) {
      return("<div style='line-height: 1.2;'>quele devint tote salvage</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.571 to correct spacing
    if (line_count == 571) {
      return("<div style='line-height: 1.2;'>Senpresfurent sidrap useit.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.573 to correct apostrophe
    if (line_count == 573) {
      return("<div style='line-height: 1.2;'>tant parliver tant par lesteit .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.576 to correct spacing
    if (line_count == 576) {
      return("<div style='line-height: 1.2;'>quians eret blance cum florr</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.583 to correct spacing
    if (line_count == 583) {
      return("<div style='line-height: 1.2;'>& tant avoit noir lementon .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.584 to correct spacing
    if (line_count == 584) {
      return("<div style='line-height: 1.2;'>comsefuist lichies dun tison</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.588 to correct spacing
    if (line_count == 588) {
      return("<div style='line-height: 1.2;'>mut vos venist agrant mervelhe</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.590 to correct spacing
    if (line_count == 590) {
      return("<div style='line-height: 1.2;'>&deblanc poilh tote mossue</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.593 to correct spacing
    if (line_count == 593) {
      return("<div style='line-height: 1.2;'>Liventres liert toz caoiz.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.601 to correct spacing
    if (line_count == 601) {
      return("<div style='line-height: 1.2;'>Ans liert vis sonescient .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.605 to correct spacing
    if (line_count == 605) {
      return("<div style='line-height: 1.2;'>Nefat aplaindreli pechiez.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.610 to correct spacing
    if (line_count == 610) {
      return("<div style='line-height: 1.2;'>deces viscat par plusorsanz</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.611 to correct spacing
    if (line_count == 611) {
      return("<div style='line-height: 1.2;'>Lepremier an devinrent dur.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.618 to correct spacing
    if (line_count == 618) {
      return("<div style='line-height: 1.2;'>derien nese desconfortoit</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.623 to correct spacing
    if (line_count == 623) {
      return("<div style='line-height: 1.2;'>Puis fut vint ans quenemanja .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.628 to correct spacing
    if (line_count == 628) {
      return("<div style='line-height: 1.2;'>kanquesoloit ja dis ameir</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.635 to correct spacing
    if (line_count == 635) {
      return("<div style='line-height: 1.2;'>Marie vat parleboscage .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.638 to correct spacing
    if (line_count == 638) {
      return("<div style='line-height: 1.2;'>parle forest vat bien segure</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.646 to correct spacing
    if (line_count == 646) {
      return("<div style='line-height: 1.2;'>Neservirent plus saintement</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.648 to correct spacing
    if (line_count == 648) {
      return("<div style='line-height: 1.2;'>kefaissoient icil sagnor</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.649 to correct apostrophe
    if (line_count == 649) {
      return("<div style='line-height: 1.2;'>entres nen astoit convoitie .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.651 to correct apostrophe
    if (line_count == 651) {
      return("<div style='line-height: 1.2;'>Navoient soig de mal affaire.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.654 to correct apostrophe
    if (line_count == 654) {
      return("<div style='line-height: 1.2;'>Navoient soig delastamine</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.660 to correct spacing
    if (line_count == 660) {
      return("<div style='line-height: 1.2;'>ce ert depain & depulment</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.664 to correct spacing
    if (line_count == 664) {
      return("<div style='line-height: 1.2;'>qui nesurdoit pas defontaine</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.665 to correct apostrophe
    if (line_count == 665) {
      return("<div style='line-height: 1.2;'>Navoient soig dargent nedor .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.668 to correct spacing
    if (line_count == 668) {
      return("<div style='line-height: 1.2;'>tant parerent de sainte vie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.670 to correct spacing
    if (line_count == 670) {
      return("<div style='line-height: 1.2;'>alpremier jor faisoient caine.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.674 to correct spacing
    if (line_count == 674) {
      return("<div style='line-height: 1.2;'>parordne lor lavoit lorpiez</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.681 to correct spacing
    if (line_count == 681) {
      return("<div style='line-height: 1.2;'>Lisaint mone sedepartoient .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.687 to correct apostrophe
    if (line_count == 687) {
      return("<div style='line-height: 1.2;'>Lialtre senissoient tuit.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.692 to correct apostrophe
    if (line_count == 692) {
      return("<div style='line-height: 1.2;'>si senfuioient encovert</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.693 to correct spacing
    if (line_count == 693) {
      return("<div style='line-height: 1.2;'>cil sen aloient sienblant .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.704 to correct spacing
    if (line_count == 704) {
      return("<div style='line-height: 1.2;'>sovenoit les deljugement</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.713 to correct spacing
    if (line_count == 713) {
      return("<div style='line-height: 1.2;'>elpuc denfer ilentreront .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.717 to correct spacing
    if (line_count == 717) {
      return("<div style='line-height: 1.2;'>por escaper legrant peril .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.719 to correct spacing
    if (line_count == 719) {
      return("<div style='line-height: 1.2;'>cant passee ert laquarantaine .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.721 to correct spacing
    if (line_count == 721) {
      return("<div style='line-height: 1.2;'>Lejor deramispalmarum .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.729 to correct spacing
    if (line_count == 729) {
      return("<div style='line-height: 1.2;'>Li premiers jors vint dekaresme .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.737 to correct spacing
    if (line_count == 737) {
      return("<div style='line-height: 1.2;'>Uns sen alat destrepartie .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.740 to correct spacing
    if (line_count == 740) {
      return("<div style='line-height: 1.2;'>mut ert vestuz depovredras</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.757 to correct spacing
    if (line_count == 757) {
      return("<div style='line-height: 1.2;'>qui ert u dome u defemme .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.762 to correct apostrophe
    if (line_count == 762) {
      return("<div style='line-height: 1.2;'>qui miez valoit dargent nedor</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.773 to correct spacing
    if (line_count == 773) {
      return("<div style='line-height: 1.2;'>tot entor li astoit sacrine .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.774 to correct spacing
    if (line_count == 774) {
      return("<div style='line-height: 1.2;'>atresiblans que pozdelmine</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.776 to correct spacing
    if (line_count == 776) {
      return("<div style='line-height: 1.2;'>Lialoient entrues kalpiet</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.777 to correct spacing
    if (line_count == 777) {
      return("<div style='line-height: 1.2;'>& navoit altrevestement .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.782 to correct spacing
    if (line_count == 782) {
      return("<div style='line-height: 1.2;'>verli en vat grant aleure</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.785 to correct spacing
    if (line_count == 785) {
      return("<div style='line-height: 1.2;'>Lisains hom levat encacant .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.787 to correct apostrophe
    if (line_count == 787) {
      return("<div style='line-height: 1.2;'>Ilnesparne miesa viellece .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.788 to correct spacing
    if (line_count == 788) {
      return("<div style='line-height: 1.2;'>petit lenest cant leblece</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.793 to correct spacing
    if (line_count == 793) {
      return("<div style='line-height: 1.2;'>Jete conjur pardelegrant .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.799 to correct spacing
    if (line_count == 799) {
      return("<div style='line-height: 1.2;'>karantesis ans at cecroi .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.802 to correct spacing
    if (line_count == 802) {
      return("<div style='line-height: 1.2;'>quenelios torner le vis</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.803 to correct spacing
    if (line_count == 803) {
      return("<div style='line-height: 1.2;'>Neli os turner mafaiture .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.814 to correct spacing
    if (line_count == 814) {
      return("<div style='line-height: 1.2;'>separlesaint sperite nom</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.820 to correct spacing
    if (line_count == 820) {
      return("<div style='line-height: 1.2;'>ver leprodome est tornee</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.823 to correct spacing
    if (line_count == 823) {
      return("<div style='line-height: 1.2;'>cipues veoir unedolente .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.824 to correct spacing
    if (line_count == 824) {
      return("<div style='line-height: 1.2;'>quien cest gast plore & gaimente</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.835 to correct spacing
    if (line_count == 835) {
      return("<div style='line-height: 1.2;'>Mercilicrie mut sovent .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.840 to correct apostrophe
    if (line_count == 840) {
      return("<div style='line-height: 1.2;'>parlebarbe quest chenue</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.843 to correct spacing
    if (line_count == 843) {
      return("<div style='line-height: 1.2;'>parlepople face orison.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.847 to correct apostrophe
    if (line_count == 847) {
      return("<div style='line-height: 1.2;'>Jenenten pas que soit raison.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.850 to correct spacing
    if (line_count == 850) {
      return("<div style='line-height: 1.2;'>porce siest plus covenant</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.854 to correct spacing
    if (line_count == 854) {
      return("<div style='line-height: 1.2;'>temain pues metresor ater</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.856 to correct spacing
    if (line_count == 856) {
      return("<div style='line-height: 1.2;'>quidetemain serat benie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.857 to correct spacing
    if (line_count == 857) {
      return("<div style='line-height: 1.2;'>Jecroi bien kepar tensinacle .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.859 to correct spacing
    if (line_count == 859) {
      return("<div style='line-height: 1.2;'>Que lipains devient lisiens cors.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.860 to correct apostrophe
    if (line_count == 860) {
      return("<div style='line-height: 1.2;'>& li vins sans quenissit fors</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.875 to correct spacing
    if (line_count == 875) {
      return("<div style='line-height: 1.2;'>totens iert en sabenetele orison.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.888 to correct apostrophe
    if (line_count == 888) {
      return("<div style='line-height: 1.2;'>si sentregardent ambe dui</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.891 to correct spacing
    if (line_count == 891) {
      return("<div style='line-height: 1.2;'>des rois des contes delaterre .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.895 to correct spacing
    if (line_count == 895) {
      return("<div style='line-height: 1.2;'>Dame Zosimas lirespont .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.896 to correct spacing
    if (line_count == 896) {
      return("<div style='line-height: 1.2;'>Deus at mis pais partot lemont</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.897 to correct spacing
    if (line_count == 897) {
      return("<div style='line-height: 1.2;'>Nest hom ki tant alheparterre .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.904 to correct spacing
    if (line_count == 904) {
      return("<div style='line-height: 1.2;'>Deus la garde parsavertu</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.907 to correct spacing
    if (line_count == 907) {
      return("<div style='line-height: 1.2;'>& deprie le Creator.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.909 to correct spacing
    if (line_count == 909) {
      return("<div style='line-height: 1.2;'>Sique saboce li movoit.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.910 to correct apostrophe
    if (line_count == 910) {
      return("<div style='line-height: 1.2;'>Mais nule vois fors nen issoit</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.912 to correct spacing
    if (line_count == 912) {
      return("<div style='line-height: 1.2;'>siqueses cors ni adeseve</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.917 to correct spacing
    if (line_count == 917) {
      return("<div style='line-height: 1.2;'>Laufaisoit saproiere .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.928 to correct spacing
    if (line_count == 928) {
      return("<div style='line-height: 1.2;'>biazperechiers porcoi tenvas</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.931 to correct apostrophe
    if (line_count == 931) {
      return("<div style='line-height: 1.2;'>batisie fui enmenfance .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.934 to correct apostrophe
    if (line_count == 934) {
      return("<div style='line-height: 1.2;'>nenpartirai juskal morir</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.936 to correct spacing
    if (line_count == 936) {
      return("<div style='line-height: 1.2;'>la sainte crois fist en sefront</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.942 to correct spacing
    if (line_count == 942) {
      return("<div style='line-height: 1.2;'>dont es tu nee dequel regne</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.944 to correct spacing
    if (line_count == 944) {
      return("<div style='line-height: 1.2;'>pordeu Dame nel celez mie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.950 to correct spacing
    if (line_count == 950) {
      return("<div style='line-height: 1.2;'>riens necelat quetot ne die</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.954 to correct apostrophe
    if (line_count == 954) {
      return("<div style='line-height: 1.2;'>poez savoir quele en ot honte</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.961 to correct spacing
    if (line_count == 961) {
      return("<div style='line-height: 1.2;'>Mercit enrent acreator .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.963 to correct spacing
    if (line_count == 963) {
      return("<div style='line-height: 1.2;'>dameporcoi kies ames piez.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.964 to correct spacing
    if (line_count == 964) {
      return("<div style='line-height: 1.2;'>pordeu tepri ketu tenliez</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.970 to correct spacing
    if (line_count == 970) {
      return("<div style='line-height: 1.2;'>pordeu aies demoi merci</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.985 to correct spacing
    if (line_count == 985) {
      return("<div style='line-height: 1.2;'>entenlit te storat gesir.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.989 to correct spacing
    if (line_count == 989) {
      return("<div style='line-height: 1.2;'>Cant passee iert lakarantaine .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.992 to correct spacing
    if (line_count == 992) {
      return("<div style='line-height: 1.2;'>dont tepri devenir amoi</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.995 to correct spacing
    if (line_count == 995) {
      return("<div style='line-height: 1.2;'>desen sanc en altre vaissel.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1002 to correct spacing
    if (line_count == 1002) {
      return("<div style='line-height: 1.2;'>porce miserai aproismie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1010 to correct spacing
    if (line_count == 1010) {
      return("<div style='line-height: 1.2;'>elgrant desert en est entree</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1014 to correct apostrophe
    if (line_count == 1014) {
      return("<div style='line-height: 1.2;'>mut est dolans quil lepert</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1015 to correct apostrophe
    if (line_count == 1015) {
      return("<div style='line-height: 1.2;'>Aterresest engenolhiez.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1020 to correct spacing
    if (line_count == 1020) {
      return("<div style='line-height: 1.2;'>ki enfemme as mis tel vertu</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1023 to correct spacing
    if (line_count == 1023) {
      return("<div style='line-height: 1.2;'>Puis limembra desenmostier .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1030 to correct apostrophe
    if (line_count == 1030) {
      return("<div style='line-height: 1.2;'>dece quil orent veu</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1033 to correct spacing
    if (line_count == 1033) {
      return("<div style='line-height: 1.2;'>Lipremier jor vint dequareme .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1035 to correct spacing
    if (line_count == 1035) {
      return("<div style='line-height: 1.2;'>ensenlit gist Zozimas.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1037 to correct spacing
    if (line_count == 1037) {
      return("<div style='line-height: 1.2;'>sot que voireert laprophetie .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1038 to correct apostrophe
    if (line_count == 1038) {
      return("<div style='line-height: 1.2;'>que loit dire Marie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1043 to correct spacing
    if (line_count == 1043) {
      return("<div style='line-height: 1.2;'>Losanc preciosement</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1044 to correct spacing
    if (line_count == 1044) {
      return("<div style='line-height: 1.2;'>porfare le comandement</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1052 to correct spacing
    if (line_count == 1052) {
      return("<div style='line-height: 1.2;'>cant il par vint vesprefut bas</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1054 to correct apostrophe
    if (line_count == 1054) {
      return("<div style='line-height: 1.2;'>mais encor nen i at il mie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1055 to correct spacing
    if (line_count == 1055) {
      return("<div style='line-height: 1.2;'>crient dela rien keplus convoite.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1056 to correct spacing
    if (line_count == 1056) {
      return("<div style='line-height: 1.2;'>queses pechiez li ait toloite</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1057 to correct apostrophe
    if (line_count == 1057) {
      return("<div style='line-height: 1.2;'>uquele iait ja esteit.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1059 to correct apostrophe
    if (line_count == 1059) {
      return("<div style='line-height: 1.2;'>delatendre soit anoie.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1060 to correct apostrophe
    if (line_count == 1060) {
      return("<div style='line-height: 1.2;'>& porce sen soit repairie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1063 to correct spacing
    if (line_count == 1063) {
      return("<div style='line-height: 1.2;'>laime veoir encor lefemme .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1064 to correct spacing
    if (line_count == 1064) {
      return("<div style='line-height: 1.2;'>qui nat senper en tot ee regne</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1065 to correct apostrophe
    if (line_count == 1065) {
      return("<div style='line-height: 1.2;'>Janenvivrai siqum jespoir .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1069 to correct spacing
    if (line_count == 1069) {
      return("<div style='line-height: 1.2;'>com passerat alflun Jordan .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1073 to correct spacing
    if (line_count == 1073) {
      return("<div style='line-height: 1.2;'>tant parest grantde ta postez.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1080 to correct spacing
    if (line_count == 1080) {
      return("<div style='line-height: 1.2;'>bele merecoment leferas</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1083 to correct spacing
    if (line_count == 1083) {
      return("<div style='line-height: 1.2;'>com passeras leflunc Jordan.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1088 to correct spacing
    if (line_count == 1088) {
      return("<div style='line-height: 1.2;'>dedens leflunc en est entree</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1090 to correct apostrophe
    if (line_count == 1090) {
      return("<div style='line-height: 1.2;'>mut senmervelhe Zozimas</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1091 to correct spacing
    if (line_count == 1091) {
      return("<div style='line-height: 1.2;'>Lisains hom li volt aidier.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1096 to correct spacing
    if (line_count == 1096) {
      return("<div style='line-height: 1.2;'>vint alsaint home sel salue</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1097 to correct spacing
    if (line_count == 1097) {
      return("<div style='line-height: 1.2;'>apresli est caue azpiez .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1098 to correct spacing
    if (line_count == 1098) {
      return("<div style='line-height: 1.2;'>engrant paor deses pechiez</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1103 to correct apostrophe
    if (line_count == 1103) {
      return("<div style='line-height: 1.2;'>Nosesor li faire signacle.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1104 to correct spacing
    if (line_count == 1104) {
      return("<div style='line-height: 1.2;'>cant Deus fait porli tel miracle</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1106 to correct spacing
    if (line_count == 1106) {
      return("<div style='line-height: 1.2;'>delaige quimut est parfunde</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1108 to correct spacing
    if (line_count == 1108) {
      return("<div style='line-height: 1.2;'>parbone foit puis lat baisie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1110 to correct apostrophe
    if (line_count == 1110) {
      return("<div style='line-height: 1.2;'>quil la li die pordeu</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1112 to correct spacing
    if (line_count == 1112) {
      return("<div style='line-height: 1.2;'>& pater nostre ensement</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1114 to correct apostrophe
    if (line_count == 1114) {
      return("<div style='line-height: 1.2;'>mut sentregardent anbedui</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1115 to correct spacing
    if (line_count == 1115) {
      return("<div style='line-height: 1.2;'>cant orent fait lorparlement .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1118 to correct spacing
    if (line_count == 1118) {
      return("<div style='line-height: 1.2;'>parcui sunt salf li pecheor</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1121 to correct spacing
    if (line_count == 1121) {
      return("<div style='line-height: 1.2;'>Mais ce est li cors Jhesu crist .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1124 to correct spacing
    if (line_count == 1124) {
      return("<div style='line-height: 1.2;'>jahom narat saint paradis</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1127 to correct spacing
    if (line_count == 1127) {
      return("<div style='line-height: 1.2;'>Mais encor aienma creance .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1129 to correct spacing
    if (line_count == 1129) {
      return("<div style='line-height: 1.2;'>porle forfait delpremier home.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1134 to correct spacing
    if (line_count == 1134) {
      return("<div style='line-height: 1.2;'>pordeu toi pri done lemoi</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1135 to correct spacing
    if (line_count == 1135) {
      return("<div style='line-height: 1.2;'>Lisains lot siderainier .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1140 to correct spacing
    if (line_count == 1140) {
      return("<div style='line-height: 1.2;'>Lecors manjat . & lesanc buit</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1142 to correct spacing
    if (line_count == 1142) {
      return("<div style='line-height: 1.2;'>onques derien nefut silie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1145 to correct apostrophe
    if (line_count == 1145) {
      return("<div style='line-height: 1.2;'>Biaz Sireoroies morison .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1146 to correct spacing
    if (line_count == 1146) {
      return("<div style='line-height: 1.2;'>& si merent me gueredon</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1163 to correct spacing
    if (line_count == 1163) {
      return("<div style='line-height: 1.2;'>Lacanteroie otes anceles.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1166 to correct spacing
    if (line_count == 1166) {
      return("<div style='line-height: 1.2;'>kecantat lirois Salomons</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1178 to correct spacing
    if (line_count == 1178) {
      return("<div style='line-height: 1.2;'>que ne vegnes amoiparler</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1189 to correct spacing
    if (line_count == 1189) {
      return("<div style='line-height: 1.2;'>cant a celliu fut parvenue .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1192 to correct spacing
    if (line_count == 1192) {
      return("<div style='line-height: 1.2;'>si senvolepat ensacrine</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1200 to correct apostrophe
    if (line_count == 1200) {
      return("<div style='line-height: 1.2;'>fors dun drapel tot derompuz</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1203 to correct spacing
    if (line_count == 1203) {
      return("<div style='line-height: 1.2;'>tant fut licors aenterrer .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1208 to correct spacing
    if (line_count == 1208) {
      return("<div style='line-height: 1.2;'>lisains cant il fut repairiez</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1211 to correct spacing
    if (line_count == 1211) {
      return("<div style='line-height: 1.2;'>kant Zozimas ot lecongiet .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1212 to correct spacing
    if (line_count == 1212) {
      return("<div style='line-height: 1.2;'>quipot eissir fors del mostier</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1214 to correct spacing
    if (line_count == 1214) {
      return("<div style='line-height: 1.2;'>Mut tost passat leflunc Jordan</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1215 to correct apostrophe
    if (line_count == 1215) {
      return("<div style='line-height: 1.2;'>tant laquise par ledesert .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1216 to correct apostrophe
    if (line_count == 1216) {
      return("<div style='line-height: 1.2;'>quil vint la u li cors ert</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1217 to correct spacing
    if (line_count == 1217) {
      return("<div style='line-height: 1.2;'>a laterre est toz extenduz .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1218 to correct spacing
    if (line_count == 1218) {
      return("<div style='line-height: 1.2;'>parpouque il nastoit toz nuz</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1220 to correct spacing
    if (line_count == 1220) {
      return("<div style='line-height: 1.2;'>unes letres vit en unbrief</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1231 to correct spacing
    if (line_count == 1231) {
      return("<div style='line-height: 1.2;'>porlebel nom si fut mut liez.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1237 to correct spacing
    if (line_count == 1237) {
      return("<div style='line-height: 1.2;'>un fust trovat paraventure .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1240 to correct apostrophe
    if (line_count == 1240) {
      return("<div style='line-height: 1.2;'>& senipot nule rien faire</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1249 to correct spacing
    if (line_count == 1249) {
      return("<div style='line-height: 1.2;'>bienseit kedeus liat tremis.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1251 to correct spacing
    if (line_count == 1251) {
      return("<div style='line-height: 1.2;'>setu voleis parmoi rienfeir .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1253 to correct spacing
    if (line_count == 1253) {
      return("<div style='line-height: 1.2;'>Lileons fut apparelhiez.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1254 to correct spacing
    if (line_count == 1254) {
      return("<div style='line-height: 1.2;'>& delcomandement mut liez</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1256 to correct spacing
    if (line_count == 1256) {
      return("<div style='line-height: 1.2;'>laterre comence afoir</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1257 to correct spacing
    if (line_count == 1257) {
      return("<div style='line-height: 1.2;'>Lileons fuet laterre dure.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1259 to correct spacing
    if (line_count == 1259) {
      return("<div style='line-height: 1.2;'>apezdevant lesraioit .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1262 to correct spacing
    if (line_count == 1262) {
      return("<div style='line-height: 1.2;'>& delaterre bien ovree</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1265 to correct apostrophe
    if (line_count == 1265) {
      return("<div style='line-height: 1.2;'>& lileons apiez latprise .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1266 to correct apostrophe
    if (line_count == 1266) {
      return("<div style='line-height: 1.2;'>entriaz dous lont enterre mise</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1267 to correct spacing
    if (line_count == 1267) {
      return("<div style='line-height: 1.2;'>cant enlaterre ont mis lecors .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1273 to correct spacing
    if (line_count == 1273) {
      return("<div style='line-height: 1.2;'>Mais cant cevint alenterrer .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1274 to correct apostrophe
    if (line_count == 1274) {
      return("<div style='line-height: 1.2;'>nelencovint somunse feir</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1276 to correct spacing
    if (line_count == 1276) {
      return("<div style='line-height: 1.2;'>sorlesaint cors le raloiat</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1280 to correct spacing
    if (line_count == 1280) {
      return("<div style='line-height: 1.2;'>signefist deprendre congiez</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1292 to correct spacing
    if (line_count == 1292) {
      return("<div style='line-height: 1.2;'>tuit serepairent en maison</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1296 to correct spacing
    if (line_count == 1296) {
      return("<div style='line-height: 1.2;'>or nesi vorat plusceler</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1301 to correct spacing
    if (line_count == 1301) {
      return("<div style='line-height: 1.2;'>comele vint a Saint Johan .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1302 to correct spacing
    if (line_count == 1302) {
      return("<div style='line-height: 1.2;'>encontreli al flun Jordan</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1303 to correct apostrophe
    if (line_count == 1303) {
      return("<div style='line-height: 1.2;'>comelealat desorelunde .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1304 to correct spacing
    if (line_count == 1304) {
      return("<div style='line-height: 1.2;'>quemut roide & parfunde</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1307 to correct apostrophe
    if (line_count == 1307) {
      return("<div style='line-height: 1.2;'>& del non quil trovat escrit.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1308 to correct apostrophe
    if (line_count == 1308) {
      return("<div style='line-height: 1.2;'>& del servise quilifit</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1312 to correct spacing
    if (line_count == 1312) {
      return("<div style='line-height: 1.2;'>Damnedeuenrendent merciz</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1315 to correct apostrophe
    if (line_count == 1315) {
      return("<div style='line-height: 1.2;'>Niot un namendast savie .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1316 to correct spacing
    if (line_count == 1316) {
      return("<div style='line-height: 1.2;'>porledeserte deMarie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1320 to correct spacing
    if (line_count == 1320) {
      return("<div style='line-height: 1.2;'>decuiavons oit lavie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1326 to correct spacing
    if (line_count == 1326) {
      return("<div style='line-height: 1.2;'>denoz armes aljugement ;</div>")
    }
    
    # Add line number div every 5th line
    line_number <- if (line_count %% 5 == 0) {
      sprintf("<div class='line-number'>%d</div>", line_count)
    } else {
      ""
    }
  } else {
    line_number <- ""
  }
  
  # Process emph elements (decorative initials)
  emph_elements <- xml_find_all(line, ".//emph")
  for (emph in emph_elements) {
    # Get the initial letter text
    initial_letter <- xml_text(emph)
    
    # Get the size attribute (n) and style attribute (rend)
    size_attr <- xml_attr(emph, "n")
    style_attr <- xml_attr(emph, "rend")
    
    # Create the HTML for the styled initial
    styled_initial <- sprintf('<span class="decorative-initial %s" data-size="%s">%s</span>', 
                             style_attr, size_attr, initial_letter)
    
    # Replace the emph element with the styled HTML
    xml_text(emph) <- styled_initial
  }
  
  # Find all <choice> elements within the line
  choices <- xml_find_all(line, ".//choice")
  for (choice in choices) {
    # Check if the <choice> element contains <abbr> and <expan>
    abbr_exists <- xml_find_first(choice, ".//abbr")
    expan_exists <- xml_find_first(choice, ".//expan")
    
    if (!is.na(abbr_exists) && !is.na(expan_exists)) {
      # If <abbr> and <expan> tags exist, extract only the <reg> text from <expan>
      reg_text <- xml_text(xml_find_first(choice, ".//expan/reg"))
      xml_set_text(choice, paste0(reg_text, " "))
    } else {
      # For non-abbreviation choices, keep original behavior
      orig_text <- xml_text(xml_find_first(choice, ".//orig"))
      xml_set_text(choice, paste0(orig_text, " "))
    }
  }
  
  # Now we want to remove any <reg> elements entirely
  reg_elements <- xml_find_all(line, ".//reg")
  xml_remove(reg_elements)
  
  # Replace <lb/> tags with HTML line break
  lb_elements <- xml_find_all(line, ".//lb")
  for (lb in lb_elements) {
    xml_set_text(lb, "")
  }
  
  # Return line with number if applicable - using xml_text() instead of as.character()
  return(sprintf("<div style='line-height: 1.2;'>%s%s</div>", 
                line_number, xml_text(line)))
}

# Process each line and wrap with <div class='column-break'> at each <cb/>
for (line in lines) {
  if (xml_name(line) == "cb") {
    # Add a closing </div> for the previous column and an opening <div> for the new column
    processed_lines <- c(processed_lines, "</div>", "<div class='column-break'>")
  } else {
    # Process the line and add it to the current column
    processed_lines <- c(processed_lines, process_line(line))
  }
}

# Process lines and wrap in edition-text div
formatted_text <- paste(c("<div class='edition-text'>", processed_lines, "</div>"), collapse = "\n")
cat(formatted_text)

```

:::

::: {.column}
## Extensive

```{r results='asis'}
# START OF "EXTENSIVE" CODE
# Read the XML content
xml_file <- read_xml("data/T-B.xml")

# Extract the <l>, <cb>, and <pb> elements inside the <text> element
lines <- xml_find_all(xml_file, "//text//l | //text//cb | //text//pb")

# Initialize an empty list to store the processed lines
processed_lines <- list()

# Initialize line counter
line_count <- 0

# Function to process each element
process_line <- function(line) {
  # Handle page breaks differently
  if (xml_name(line) == "pb") {
    # Get folio number and format as standalone line
    folio_num <- xml_attr(line, "n")
    return(sprintf("<div class='folio-number'>%s</div>", folio_num))
  }
  
  # Only increment line count for verse lines
  if (xml_name(line) == "l") {
    line_count <<- line_count + 1
    
    # SPECIAL CASE: Hard-code line v.36 to correct spacing
    if (line_count == 36) {
      return("<div style='line-height: 1.2;'>tros qu'il sent el cors le mort</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.184 to correct double "Creator"
    if (line_count == 184) {
      return("<div style='line-height: 1.2;'>cant de se Creator n'at cure</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.371 to correct double "Deus"
    if (line_count == 371) {
      return("<div style='line-height: 1.2;'>seit ke Deus est ver li iriez.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.376 to correct double "Deus"
    if (line_count == 376) {
      return("<div style='line-height: 1.2;'>por quoi Deus est ver vos iriez</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.378 to correct double "Creator"
    if (line_count == 378) {
      return("<div style='line-height: 1.2;'>cant men Creator ai perdu</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.384 to correct spacing
    if (line_count == 384) {
      return("<div style='line-height: 1.2;'>celi poise qu'ele est vive</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.393 to correct double "Marie"
    if (line_count == 393) {
      return("<div style='line-height: 1.2;'>cant il te dist ave Marie.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.394 to correct double "Deu grasce"
    if (line_count == 394) {
      return("<div style='line-height: 1.2;'>de la Deu grasce raemplie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.419 to correct double "Peres"
    if (line_count == 419) {
      return("<div style='line-height: 1.2;'>Il fut tes Fiz si fut tes Peres.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.461 to correct double "Pere"
    if (line_count == 461) {
      return("<div style='line-height: 1.2;'>diluc les condost a sen Pere.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.470 to correct double "Pere"
    if (line_count == 470) {
      return("<div style='line-height: 1.2;'>en ciel monta puis a sen Pere</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.475 to correct double "Pere"
    if (line_count == 475) {
      return("<div style='line-height: 1.2;'>or siet a la destre sen Pere.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.558 to correct double "Deus"
    if (line_count == 558) {
      return("<div style='line-height: 1.2;'>se Deus ne li fait altre aie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.566 to correct double "Damledeu"
    if (line_count == 566) {
      return("<div style='line-height: 1.2;'>a Damledeu se comandoit</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.666 to correct double "Deu"
    if (line_count == 666) {
      return("<div style='line-height: 1.2;'>a Deu avoient lor tresor</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.680 to correct double "Damledeu"
    if (line_count == 680) {
      return("<div style='line-height: 1.2;'>a Damledeu les comandoit</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.689 to correct double "Deu"
    if (line_count == 689) {
      return("<div style='line-height: 1.2;'>en Deu avoient grant amor.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.690 to correct double "Deu"
    if (line_count == 690) {
      return("<div style='line-height: 1.2;'>de Deu vivoient li plusor</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.736 to correct double "Damledeu"
    if (line_count == 736) {
      return("<div style='line-height: 1.2;'>A Damledeu les comandat</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.767 to correct double "Felon"
    if (line_count == 767) {
      return("<div style='line-height: 1.2;'>Que le defende del Felon.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.770 to correct double "Marie"
    if (line_count == 770) {
      return("<div style='line-height: 1.2;'>La figure vit de Marie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.771 to correct double "Marie"
    if (line_count == 771) {
      return("<div style='line-height: 1.2;'>de Marie vit la figure.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.792 to correct double "Deu"
    if (line_count == 792) {
      return("<div style='line-height: 1.2;'>se tu en Deu as nule foi</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.793 to correct double "De le grant"
    if (line_count == 793) {
      return("<div style='line-height: 1.2;'>Je te conjur par De le grant.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.795 to correct double "Deu"
    if (line_count == 795) {
      return("<div style='line-height: 1.2;'>cant la dame ot de Deu parler .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.840 to correct spacing
    if (line_count == 840) {
      return("<div style='line-height: 1.2;'>par le barbe quest chenue</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.895 to correct spacing
    if (line_count == 895) {
      return("<div style='line-height: 1.2;'>Dame Zosimas li respont .</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.932 to correct double "Deu"
    if (line_count == 932) {
      return("<div style='line-height: 1.2;'>en Deu ai tote ma fiance</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.944 to correct double "Deu"
    if (line_count == 944) {
      return("<div style='line-height: 1.2;'>por Deu Dame nel celez mie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.961 to correct double "Creator"
    if (line_count == 961) {
      return("<div style='line-height: 1.2;'>Mercit en rent a Creator.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.964 to correct double "Deu"
    if (line_count == 964) {
      return("<div style='line-height: 1.2;'>por Deu te pri ke tu ten liez</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.970 to correct double "Deu"
    if (line_count == 970) {
      return("<div style='line-height: 1.2;'>por Deu aies de moi merci</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1110 to correct double "Deu"
    if (line_count == 1110) {
      return("<div style='line-height: 1.2;'>quil la li die por Deu</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1134 to correct double "Deu"
    if (line_count == 1134) {
      return("<div style='line-height: 1.2;'>por Deu toi pri done le moi</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1183 to correct double "Deu"
    if (line_count == 1183) {
      return("<div style='line-height: 1.2;'>Dame dist il a Deu plaisir.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1198 to correct double "Marie"
    if (line_count == 1198) {
      return("<div style='line-height: 1.2;'>en alat larme de Marie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1230 to correct double "Deu"
    if (line_count == 1230) {
      return("<div style='line-height: 1.2;'>sel sevelis a Deu aie</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1249 to correct double "Deus"
    if (line_count == 1249) {
      return("<div style='line-height: 1.2;'>bien seit ke Deus li at tremis.</div>")
    }
    
    # SPECIAL CASE: Hard-code line v.1316 to correct double "Marie"
    if (line_count == 1316) {
      return("<div style='line-height: 1.2;'>por le deserte de Marie</div>")
    }
    
    # Add line number div every 5th line
    line_number <- if (line_count %% 5 == 0) {
      sprintf("<div class='line-number'>%d</div>", line_count)
    } else {
      ""
    }
  } else {
    line_number <- ""
  }
  
  # Process emph elements (decorative initials)
  emph_elements <- xml_find_all(line, ".//emph")
  for (emph in emph_elements) {
    # Get the initial letter text
    initial_letter <- xml_text(emph)
    
    # Get the size attribute (n) and style attribute (rend)
    size_attr <- xml_attr(emph, "n")
    style_attr <- xml_attr(emph, "rend")
    
    # Create the HTML for the styled initial
    styled_initial <- sprintf('<span class="decorative-initial %s" data-size="%s">%s</span>', 
                             style_attr, size_attr, initial_letter)
    
    # Replace the emph element with the styled HTML
    xml_text(emph) <- styled_initial
  }
  
  # Now we want to remove any <orig> elements entirely
  orig_elements <- xml_find_all(line, ".//orig")
  xml_remove(orig_elements)
  
  # Find all <choice> elements within the line
  choices <- xml_find_all(line, ".//choice")
  for (choice in choices) {
    # Extract the text from the <reg> tag
    reg_text <- xml_text(xml_find_first(choice, ".//reg"))
    # Replace the <choice> element with the text from the <reg> tag
    xml_set_text(choice, paste0(" ", reg_text, " "))
  }
  
  # Replace <lb/> tags with HTML line break
  lb_elements <- xml_find_all(line, ".//lb")
  for (lb in lb_elements) {
    xml_set_text(lb, "")
  }
  
  # Return line with number if applicable - using xml_text() instead of as.character()
  return(sprintf("<div style='line-height: 1.2;'>%s%s</div>", 
                line_number, xml_text(line)))
}

# Process each line and wrap with <div class='column-break'> at each <cb/>
for (line in lines) {
  if (xml_name(line) == "cb") {
    # Add a closing </div> for the previous column and an opening <div> for the new column
    processed_lines <- c(processed_lines, "</div>", "<div class='column-break'>")
  } else {
    # Process the line and add it to the current column
    processed_lines <- c(processed_lines, process_line(line))
  }
}

# Process lines and wrap in edition-text div
formatted_text <- paste(c("<div class='edition-text'>", processed_lines, "</div>"), collapse = "\n")
cat(formatted_text)

```

:::

::: :::
